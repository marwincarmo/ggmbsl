install.packages("BDgraph")
library(dplyr)
d <- readRDS("out/df_bggm_216.rds")
d
d %>%
tidyr::pivot_longer(cols = p_plus:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value) |>
dplyr::filter( p == 100) |>
print(n = Inf)
d %>%
tidyr::pivot_longer(cols = sensitivity:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value) |>
dplyr::filter( p == 100) |>
print(n = Inf)
d %>%
tidyr::pivot_longer(cols = sensitivity:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value) |>
#dplyr::filter( p == 100) |>
print(n = Inf)
d <- readRDS("sftp://marwin@169.237.158.143/home/users/marwin.AD3/projects/ggmbsl/out/df_bggm_216.rds")
d <- readRDS("out/df_bggm_216.rds")
d %>%
tidyr::pivot_longer(cols = sensitivity:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value) |>
#dplyr::filter( p == 100) |>
print(n = Inf)
d %>%
tidyr::pivot_longer(cols = sensitivity:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value) |>
#dplyr::filter( p == 100) |>
print(n = Inf)
install.packages("synthpop")
library(dplyr)
bda_df <- readRDS("out/df_624.rds")
bggm_df <- rbind(
readRDS("out/df_bggm_143.rds"),
readRDS("out/df_bggm_216.rds"))
rj_df <- readRDS("out/df_rj_528")
## 1.2 Summarise results
get_summary <- function(df) {
df |>
tidyr::pivot_longer(cols = p_plus:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(condition_id, p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value)
}
names(bda_df)
names(bggm_df)
s_bda <- get_summary(bda_df)
s_bggm <- get_summary(bggm_df)
print(s_bda, n = Inf)
print(s_bda, n = Inf)
library(dplyr)
library(ggplot2)
bggm_df <- readRDS("out/df_bggm_216.rds")
## 1.2 Summarise results
get_summary <- function(df) {
df |>
tidyr::pivot_longer(cols = p_plus:relative_strength_mae) |>
dplyr::group_by(dplyr::across(c(p:name))) |>
dplyr::summarise(value = mean(value)) |>
tidyr::pivot_wider(names_from = name, values_from = value)
}
s_bggm <- get_summary(bggm_df)
print(s_bggm, n = Inf, width = Inf)
readRDS("out/df_bggm_148.rds")
readRDS("out/df_bggm_147.rds")
readRDS("out/df_bggm_147.rds") |> pull(condition_id) |> unique()
readRDS("out/df_bggm_148.rds") |> pull(condition_id) |> unique()
readRDS("out/df_bggm_216.rds") |> pull(condition_id) |> unique()
bggm_df <- rbind(readRDS("out/df_bggm_24.rds"),
readRDS("out/df_bggm_147.rds"),
readRDS("out/df_bggm_216.rds"))
bggm_df
s_bggm <- get_summary(bggm_df)
s_bggm
head(bggm_df)
bda_df <- readRDS("out/df_624.rds")
head(bda_df)
table(bggm_df$condition_id)
library(BGGM)
library(pROC)
library(corpcor)
library(tidyr)
library(dplyr)
# Source helper file
source("helpers.R")
# --- 1. SIMULATION SETUP ---
# Define levels for each factor
p_levels <- c(10, 25, 100)
n_mult_levels <- c(1, 5, 20)
graph_type_levels <- c("random", "small-world")
graph_prob_levels <- c(0.2, 0.5, 0.8) # Sparse vs. Dense target
# Define levels for the key hyperparameter: SD of partial correlations
# sd_pcor < 0.3 means a strong prior concentrating effects near zero
# sd_pcor > 0.4 means a weak prior allowing for large effects
sd_pcor_levels <- c(0.2, 0.5)
conditions_grid <- tidyr::crossing(
p = p_levels,
n_multiplier = n_mult_levels,
graph_type = graph_type_levels,
graph_prob = graph_prob_levels,
true_sd_pcor = sd_pcor_levels,
prior_sd_pcor = sd_pcor_levels
) |>
dplyr::mutate(n = p * n_multiplier) |>
dplyr::select(-n_multiplier)
conditions_grid
length(bggm_df$condition_id)
length(unique(bggm_df$condition_id))
unique(bggm_df$condition_id)
unique(bggm_df$condition_id) %in% 1:216
length(unique(bggm_df$condition_id))
1:216 %in% unique(bggm_df$condition_id)
conditions_grid$condition_id = 1:nrow(conditions_grid)
conditions_grid
conditions_grid$condition_id[bggm_df$condition_id]
expanded_ids = conditions_grid$condition_id[bggm_df$condition_id]
bggm_df |>
dplyr::left_join(select(conditions_grid, graph_prob, condition_id), by = "condition_id")
select(conditions_grid, graph_prob, condition_id)
bggm_df |>
dplyr::left_join(select(conditions_grid, c(graph_prob, condition_id)), by = "condition_id")
bggm_df |>
dplyr::left_join(dplyr::select(conditions_grid, c(graph_prob, condition_id)), by = "condition_id")
head(bda_df)
head(bggm_df)
bggm_df |>
dplyr::left_join(dplyr::select(conditions_grid, c(graph_prob, condition_id)),
by = "condition_id") |>
dplyr::select(condition_id:graph_type, graph_prob, dplyr::everything())
bggm_df |>
dplyr::left_join(dplyr::select(conditions_grid, c(graph_prob, condition_id)),
by = "condition_id") |>
dplyr::select(condition_id:graph_type, graph_prob, dplyr::everything()) |>
saveRDS("out/df_bggm_fix.rds")
bggm_df <- readRDS("out/df_bggm_fix.rds")
bggm_df
s_bggm <- get_summary(bggm_df)
s_bggm
print(s_bggm, n = Inf, width = Inf)
